$(document).ready(function(){function a(){d=$("#main").width()-g.left-g.right,e=[.8*d,.75*$(window).height()],f=d3.min(e),d3.select("#map_svg").attr("width",d).attr("height",f),console.log(f)}function b(){var a=d3.event.transform;d3.select("#map_g").attr("transform","translate("+a.x+","+a.y+") scale("+a.k+")")}function c(a,b){console.log(b);var c=topojson.feature(b,b.objects.countries).features;console.log(c),k.selectAll(".country").data(c).enter().append("path").attr("class","country").attr("d",j)}var d,e,f,g={top:0,left:0,right:0,bottom:0};a(),d3.select(window).on("resize",a);var h=d3.zoom().scaleExtent([.15,10]).on("zoom",b),i=d3.geoMercator().translate([d/2,f/2]).scale([d/5]);d3.queue().defer(d3.json,"/json/world-mb.topojson ").defer(d3.csv,"/csv/retailers.csv").await(c);var j=d3.geoPath().projection(i),k=d3.select("#main").append("svg").attr("width",d).attr("height",f).attr("id","map_svg").style("border","1px solid #efefef").call(h).append("g").attr("id","map_g")});